<!--pages/me/me.wxml-->

<!-- å¯¼èˆªæ  -->
<view class="nav-bar">
  <text class="nav-title">ä¸ªäººä¸­å¿ƒ</text>
  <view class="nav-right">
    <text class="nav-icon">âš™ï¸</text>
  </view>
</view>

<!-- ä¸»å†…å®¹åŒº -->
<scroll-view class="main-content" scroll-y enhanced="true" bounces="true" show-scrollbar="false">
  <!-- ç”¨æˆ·èµ„æ–™å¡ç‰‡ -->
  <view class="user-card">
    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view class="user-info" wx:if="{{isLogin}}">
      <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      <view class="user-details">
        <view class="name-badge">
          <text class="user-name">{{userInfo.nickName}}</text>
          <text class="user-badge">{{userGrade}}</text>
        </view>
        <text class="user-school">{{userSchool}}</text>
        <text class="user-class">{{userClass}}</text>
      </view>
      <button class="edit-btn" bindtap="editProfile">ç¼–è¾‘èµ„æ–™</button>
    </view>
    
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view class="login-section" wx:else>
      <view class="login-avatar-section">
        <button class="avatar-btn" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
          <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        </button>
      </view>
      <view class="login-info">
        <view class="login-tips">ç™»å½•åå¯åŒæ­¥å­¦ä¹ æ•°æ®ï¼Œå‚ä¸æ’è¡Œæ¦œ</view>
        <button class="wechat-btn" bindtap="navigateToLogin">
          <text class="wechat-btn-icon">ğŸ”</text> ç™»å½•/æ³¨å†Œ
        </button>
      </view>
    </view>
    
    <view class="user-stats">
      <view class="stat-item">
        <text class="stat-value">{{streak}}</text>
        <text class="stat-label">è¿ç»­å¤©æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{points}}</text>
        <text class="stat-label">ç§¯åˆ†</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{ranking}}</text>
        <text class="stat-label">æ’å</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{medals}}</text>
        <text class="stat-label">å‹‹ç« </text>
      </view>
    </view>
  </view>
  
  <!-- åŠŸèƒ½åŒºåŸŸ -->
  <view class="feature-section">
    <view class="feature-grid">
      <view class="feature-item" bindtap="navigateTo" data-url="../mistake/list">
        <view class="feature-icon feature-icon-red">ğŸ“•</view>
        <text class="feature-text">é”™é¢˜æœ¬</text>
      </view>
      <view class="feature-item" bindtap="navigateTo" data-url="../favorite/list">
        <view class="feature-icon feature-icon-blue">â­</view>
        <text class="feature-text">æ”¶è—</text>
      </view>
      <view class="feature-item" bindtap="navigateTo" data-url="../history/list">
        <view class="feature-icon feature-icon-green">ğŸ•’</view>
        <text class="feature-text">å†å²è®°å½•</text>
      </view>
      <view class="feature-item" bindtap="navigateTo" data-url="../download/list">
        <view class="feature-icon feature-icon-purple">ğŸ“¥</view>
        <text class="feature-text">ä¸‹è½½</text>
      </view>
    </view>
  </view>
  
  <!-- å­¦ä¹ æ•°æ® -->
  <view class="stats-section">
    <text class="section-title">å­¦ä¹ æ•°æ®</text>
    <view class="subject-stats">
      <view class="subject-item">
        <view class="subject-header">
          <text class="subject-name">æ•°å­¦</text>
          <text class="subject-meta">{{mathStats.completed}}é¢˜ Â· {{mathStats.correctRate}}%æ­£ç¡®ç‡</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill progress-blue" style="width: {{mathStats.correctRate}}%"></view>
        </view>
      </view>
      
      <view class="subject-item">
        <view class="subject-header">
          <text class="subject-name">ç‰©ç†</text>
          <text class="subject-meta">{{physicsStats.completed}}é¢˜ Â· {{physicsStats.correctRate}}%æ­£ç¡®ç‡</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill progress-purple" style="width: {{physicsStats.correctRate}}%"></view>
        </view>
      </view>
      
      <view class="subject-item">
        <view class="subject-header">
          <text class="subject-name">åŒ–å­¦</text>
          <text class="subject-meta">{{chemistryStats.completed}}é¢˜ Â· {{chemistryStats.correctRate}}%æ­£ç¡®ç‡</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill progress-green" style="width: {{chemistryStats.correctRate}}%"></view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- å•†åŸä¼šå‘˜ -->
  <view class="vip-section" bindtap="showVipDetails">
    <view class="vip-icon">ğŸ‘‘</view>
    <view class="vip-info">
      <text class="vip-title">å¼€é€šä¼šå‘˜äº«æ›´å¤šç‰¹æƒ</text>
      <text class="vip-desc">æµ·é‡é¢˜åº“ã€è¯¾ç¨‹ã€ç­”ç–‘ã€æ€ç»´å¯¼å›¾...</text>
    </view>
    <button class="vip-btn">äº†è§£è¯¦æƒ…</button>
  </view>
  
  <!-- å…¶ä»–é€‰é¡¹åˆ—è¡¨ -->
  <view class="options-list">
    <view class="option-item" bindtap="navigateTo" data-url="../invite/index">
      <text class="option-icon">ğŸ‘¥</text>
      <text class="option-text">é‚€è¯·å¥½å‹</text>
      <text class="option-arrow">></text>
    </view>
    
    <view class="option-item" bindtap="navigateTo" data-url="../feedback/index">
      <text class="option-icon">ğŸ’¬</text>
      <text class="option-text">æ„è§åé¦ˆ</text>
      <text class="option-arrow">></text>
    </view>
    
    <view class="option-item" bindtap="contactService">
      <text class="option-icon">ğŸ§</text>
      <text class="option-text">è”ç³»å®¢æœ</text>
      <text class="option-arrow">></text>
    </view>
    
    <view class="option-item" bindtap="navigateTo" data-url="../about/index">
      <text class="option-icon">â„¹ï¸</text>
      <text class="option-text">å…³äºæˆ‘ä»¬</text>
      <text class="option-arrow">></text>
    </view>
    
    <view class="option-item" bindtap="navigateTo" data-url="../settings/index">
      <text class="option-icon">âš™ï¸</text>
      <text class="option-text">è®¾ç½®</text>
      <text class="option-arrow">></text>
    </view>
  </view>
  
  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸå ä½ -->
  <view class="safe-area-bottom"></view>
</scroll-view>
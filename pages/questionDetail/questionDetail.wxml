<!--pages/questionDetail/questionDetail.wxml-->

<!-- å¯¼èˆªæ  -->
<view class="nav-bar">
  <view class="nav-left" bindtap="goBack">
    <text class="nav-back-icon">â†</text>
  </view>
  <text class="nav-title">é¢˜ç›®è¯¦æƒ…</text>
  <view class="nav-right">
    <text class="nav-icon">âš™ï¸</text>
  </view>
</view>

<!-- ä¸»å†…å®¹åŒº -->
<scroll-view class="main-content" scroll-y type="list" enhanced="true" bounces="true" show-scrollbar="false">
  <!-- é¢˜ç›®è¿›åº¦ -->
  <view class="progress-bar">
    <view class="question-count">
      <text class="current-question">{{currentQuestion}}</text>/{{totalQuestions}}
    </view>
    <view class="navigation-buttons">
      <view class="nav-button prev" bindtap="prevQuestion">
        <text>â†</text>
      </view>
      <view class="nav-button next" bindtap="nextQuestion">
        <text>â†’</text>
      </view>
    </view>
  </view>

  <!-- é¢˜ç›®å¡ç‰‡ -->
  <view class="question-card">
    <!-- é¢˜ç›®ä¿¡æ¯ -->
    <view class="question-header">
      <view class="question-badges">
        <text class="badge primary">{{question.type}}</text>
        <text class="badge secondary">{{question.difficulty}}</text>
      </view>
      <view class="action-buttons">
        <view class="action-button" bindtap="toggleBookmark">
          <text>{{isBookmarked ? 'â˜…' : 'â˜†'}}</text>
        </view>
        <view class="action-button" bindtap="reportQuestion">
          <text>ğŸš©</text>
        </view>
      </view>
    </view>
    
    <!-- é¢˜ç›®å†…å®¹ -->
    <view class="question-content">
      <text>{{question.content}}</text>
      <view wx:if="{{question.image}}" class="question-image-container">
        <image src="{{question.image}}" mode="widthFix" class="question-image"></image>
        <text class="image-caption">{{question.imageCaption || ''}}</text>
      </view>
    </view>
    
    <!-- é€‰é¡¹ -->
    <view class="options-list">
      <view wx:for="{{question.options}}" wx:key="index" class="option {{selectedOption === item.key ? 'selected' : ''}}" 
           bindtap="selectOption" data-option="{{item.key}}">
        <view class="option-key {{selectedOption === item.key ? 'selected' : ''}}">
          {{item.key}}
        </view>
        <view class="option-content">{{item.value}}</view>
      </view>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="submit-button-container">
      <button class="submit-button" bindtap="submitAnswer" wx:if="{{!showAnswer}}">æäº¤</button>
    </view>
  </view>
  
  <!-- æ­£ç¡®ç­”æ¡ˆå’Œè§£æï¼ˆé»˜è®¤éšè—ï¼Œæäº¤åæ˜¾ç¤ºï¼‰ -->
  <view class="answer-section" wx:if="{{showAnswer}}">
    <view class="section-header">
      <text class="section-icon">âœ“</text>
      <text class="section-title">ç­”æ¡ˆä¸è§£æ</text>
    </view>
    <view class="correct-answer">
      <text class="label">æ­£ç¡®ç­”æ¡ˆ:</text>
      <text class="answer-key">{{question.correctAnswer}}</text>
    </view>
    <view class="answer-value">
      <text>{{question.correctAnswerValue}}</text>
    </view>
    <view class="explanation-section">
      <text class="label">è§£æ:</text>
      <view class="explanation-content">
        <text wx:for="{{question.explanation}}" wx:key="index">{{item}}</text>
      </view>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-section">
    <view class="stat-item">
      <text class="stat-icon">ğŸ‘ï¸</text>
      <text class="stat-value">{{question.viewCount}}äººå·²åš</text>
    </view>
    <view class="stat-item">
      <text class="stat-icon">ğŸ“Š</text>
      <text class="stat-value">æ­£ç¡®ç‡: {{question.correctRate}}%</text>
    </view>
    <view class="stat-item">
      <text class="stat-icon">â±ï¸</text>
      <text class="stat-value">å¹³å‡ç”¨æ—¶: {{question.avgTime}}</text>
    </view>
  </view>
  
  <!-- è®¨è®ºåŒº -->
  <view class="discussion-section">
    <view class="section-header">
      <text class="section-title">è®¨è®ºåŒº ({{question.commentCount}}æ¡)</text>
      <view class="add-comment" bindtap="addComment">
        <text>+</text> æ·»åŠ 
      </view>
    </view>
    
    <view class="comments-list">
      <view wx:for="{{question.comments}}" wx:key="index" class="comment-item">
        <view class="user-avatar">
          <image src="{{item.userAvatar}}" mode="aspectFill"></image>
        </view>
        <view class="comment-content">
          <view class="comment-header">
            <text class="user-name">{{item.userName}}</text>
            <text class="comment-time">{{item.timeAgo}}</text>
          </view>
          <text class="comment-text">{{item.content}}</text>
          <view class="comment-actions">
            <view class="action-item" bindtap="likeComment" data-id="{{item.id}}">
              <text class="action-icon">ğŸ‘</text>
              <text class="action-count">{{item.likeCount}}</text>
            </view>
            <view class="action-item" bindtap="replyComment" data-id="{{item.id}}">
              <text class="action-icon">ğŸ’¬</text>
              <text>å›å¤</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <view class="view-more" bindtap="viewMoreComments">
      æŸ¥çœ‹æ›´å¤šè®¨è®º â–¼
    </view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸå ä½ -->
  <view class="safe-area-bottom"></view>
</scroll-view>

<!-- åº•éƒ¨æ“ä½œæ  -->
<view class="tab-bar">
  <view class="tab-item" bindtap="toggleBookmark">
    <text class="tab-icon">{{isBookmarked ? 'â˜…' : 'â˜†'}}</text>
    <text class="tab-text">æ”¶è—</text>
  </view>
  <view class="tab-item" bindtap="viewComments">
    <text class="tab-icon">ğŸ’¬</text>
    <text class="tab-text">è®¨è®º</text>
  </view>
  <view class="tab-item" bindtap="shareQuestion">
    <text class="tab-icon">ğŸ“¤</text>
    <text class="tab-text">åˆ†äº«</text>
  </view>
  <view class="tab-item next-btn" bindtap="nextQuestion">
    <text class="tab-text">ä¸‹ä¸€é¢˜</text>
    <text class="tab-icon">â†’</text>
  </view>
</view>